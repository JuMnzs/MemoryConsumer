<!DOCTYPE html>
<html>
<head>
    <title>Teste de Memória RAM</title>
</head>
<body>
    <h1>Teste de Memória RAM</h1>
    <p>A página consumirá até 1.5GB de memória antes de parar.</p>
    <button onclick="startMemoryConsumption()">Iniciar Consumo de Memória</button>

    <script>
        const consumir = [];
        let memoryLeakActive = false;

        function consumirMemory() {
            if (!memoryLeakActive) return;

            const intervaloDeConsumo = new Array(300 * 1024 * 1024).fill('M');
            consumir.push(intervaloDeConsumo);

            if (window.performance && window.performance.memory) {
                const memoria = window.performance.memory;
                const memoriaUsada = memoria.usedJSHeapSize / (1024 * 1024);
                const limite = 1500;

                if (memoriaUsada > limite) {
                    console.log("Memória usada excedeu 1.5GB. Parando consumo.");
                    memoryLeakActive = false;
                    consumir.length = 0; 
                    return;
                }
            }
            setTimeout(consumirMemory, 1000);
        }

        function startMemoryConsumption() {
            memoryLeakActive = true;
            consumirMemory();
        }
    </script>
</body>
</html>
